<!DOCTYPE html>
<html>
<head>
	<title>Harry Potter Trivia</title>
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">	
	<link rel="stylesheet" type="text/css" href="./assets/css/style.css">
	<script src="https://code.jquery.com/jquery.js"></script>
	<script type="text/javascript" src="./assets/javascript/app.js"></script>
</head>
<body>
	<div class="container">
		
		<div class="jumbotron text-center"> 
			<h1>Harry Potter Trivia</h1>
		</div>
		
		
			<div class="row">
				<div class="col-sm-6 text-center">
					<div id="questionCounter" class="text-center"><h2>Question 1</h2></div>
				</div>	
				<div class="col-sm-6 text-center">
					<div id="timer"><h2>Time Remaining: 20 Seconds</h2></div>
				</div>	

			</div>
			
			<div id="hiddenStuff" class="text-center">
				<img src="./assets/images/endGame.gif">
			</div>			
		
		<div id="entireTriviaContents">		
			<div class="row">
				<div id="nextQuestion" class="center-block col-sm-12 text-center">
					<h2>Question</h2>
				</div>
			</div>

			
			<form id="triviaForm">
				<div class="row">
					<div class="col-sm-6 text-center">
						<div>
							<input type="radio" name="option" class="option" value="A">
								<span id="optionOne"><h3>Answer 1</h3></span>
						</div>
					</div>
					<div class="col-sm-6 text-center">
						<div>
							<input type="radio" name="option" class="option" value="B">
								<span id="optionTwo"><h3>Answer 2</h3></span>
						</div>
					</div>
				</div>
					<div class="row">
					<div class="col-sm-6 text-center">
						<div>
							<input type="radio" name="option" class="option" value="C">
								<span id="optionThree"><h3>Answer 3</h3></span>
						</div>
					</div>
					<div class="col-sm-6 text-center">
						<div>
							<input type="radio" name="option" class="option" value="D">
								<span id="optionFour"><h3>Answer 4</h3></span>
						</div>
					</div>
					<div class="col-sm-12 text-center">
						<div id="submitButton">
							<button class="btn btn-success btn-lg">Submit</button>
						</div>
					</div>
					<div class="col-sm-12 text-center">
						<div id="showResults">
						</div>
					</div>
				</div>
			</form>
		</div>	
	</div>
	<script type="text/javascript">

		window.onload = function(){
			
			var $submitButton = $("#submitButton");
			var $nextQuestion = $("#nextQuestion");
			var $showResults = $("#showResults");
			var $triviaForm = $("#triviaForm");
			var $questionCounter = $("#questionCounter");
			var $optionOne = $("#optionOne");
			var $optionTwo = $("#optionTwo");
			var $optionThree = $("#optionThree");
			var $optionFour = $("#optionFour");
			var $hiddenStuff = $("#hiddenStuff");

			var correctAnswer = "";
			var userGuess = "";
			var answerText = "";
			var questionNumber = 4;
			var questionsCorrect = 0;
			var questionsIncorrect = 0;
			var timerCount = 20;
			var timerResetValue = 20;
			var intervalID;
			var questionCounter = 0;

			var questionArray = [
				
				{	"Option" : 1,
					"Answer" : "A",
					"OptionOne" : "He eats Gillyweed",
					"OptionTwo" : "He transfigures into a shark",
					"OptionThree" : "He performs a bubble-head charm",
					"OptionFour" : "He kisses a mermaid",
					"Question" : "How does Harry manage to breathe underwater during the second task of the Triwizard Tournament?",
					"AnswerText" : "The correct answer was: A. He eats Gillyweed"}
				,

				{	"Option" : 2,
					"Answer" : "B",
					"OptionOne" : "Avada Kedavra",
					"OptionTwo" : "Sectumsempra",
					"OptionThree" : "Cruciatus Curse",
					"OptionFour" : "Imperius Curse",					
					"Question" : "Which of these is NOT one of the Unforgivable Curses?",
					"AnswerText" : "The correct answer was: B. Sectumsempra is not one of the Unforgivable Curses"}
				,

				{	"Option" : 3,
					"Answer" : "D",
					"OptionOne" : "The Grey Lady",
					"OptionTwo" : "The Fat Friar",
					"OptionThree" : "The Bloody Baron",
					"OptionFour" : "The Fat Lady",					
					"Question" : "Who guards the entrance to the Gryffindor common room?",
					"AnswerText" : "The correct answer was: D. The Fat Lady guards the entrance to the Gryffindor common room"}	
				,

				{	"Option" : 4,
					"Answer" : "B",
					"OptionOne" : "Mad-Eye Moody",
					"OptionTwo" : "Cornelius Fudge",
					"OptionThree" : "Professor Snape",
					"OptionFour" : "Remus Lupin",					
					"Question" : "Who is NOT a member of the Order of the Phoenix?",
					"AnswerText" : "The correct answer was: B. Cornelius Fudge is NOT a member of the Order of the Phoenix"}										

			];

			function getNewQuestion(){

				$("#entireTriviaContents").css('display', 'block');
				
				$triviaForm.each(function(){
					this.reset();
				});				

				if (questionCounter < questionNumber){

				//clear form contents for new question


				userGuess = "";

				$nextQuestion.html("<h2>" + questionArray[questionCounter].Question + "</h2>");
				$questionCounter.html("<h2>Question " + questionArray[questionCounter].Option + "</h2");
				console.log(questionArray[questionCounter]);
				correctAnswer = questionArray[questionCounter].Answer;
				answerText = questionArray[questionCounter].AnswerText;
				$optionOne.html(questionArray[questionCounter].OptionOne);
				$optionTwo.html(questionArray[questionCounter].OptionTwo);
				$optionThree.html(questionArray[questionCounter].OptionThree);
				$optionFour.html(questionArray[questionCounter].OptionFour);
			}
			    else if (questionCounter === questionNumber)
			    	{
			    	stopTimer();
			    	$("#entireTriviaContents").css('display', 'none');
			    	// alert("Game Over!");
			    	informationScreen();
			    	}			
			}

			function timerCountDown(){
				intervalID = setInterval(decrement, 1000);
			}

			function decrement() {

				if (questionCounter < questionNumber){

				timerCount -- ;

				$("#timer").html("<h2>Time Remaining: " + timerCount + " Seconds</h2>");

				if (timerCount === 0) {

					stopTimer();
					questionsIncorrect += 1;
					console.log("Question Number: " + questionCounter);
					console.log("User Input: " + userGuess);
					console.log("Correct Answer: " + correctAnswer);
					console.log("Questions Correct: " + questionsCorrect);
					console.log("Questions Incorrect: " + questionsIncorrect);					
					questionCounter += 1;
					getNewQuestion();
					timerCount = timerResetValue;
					timerCountDown();
			      
			      }
			  }
			  else if (questionCounter === questionNumber){
			  	stopTimer();
			  }
			   
			}

			function stopTimer(){
				clearInterval(intervalID);			

			}
			function informationScreen(){

				$("#entireTriviaContents").css('display', 'none');
				$hiddenStuff.css('display', 'block');
				
				$hiddenStuff.prepend("<h3>Game Over!</h3>");
				$hiddenStuff.append("<br>Correct Answers: " + questionsCorrect +
					"<br>Incorrect Answers: " + questionsIncorrect);
				
				var a = $("<button> Reset </button>");
				a.addClass("reset btn btn-lg btn-danger center-block");
				$hiddenStuff.append(a);

				$(".reset").on('click', function(){
					event.preventDefault();
					$("#entireTriviaContents").css('display', 'block');
					correctAnswer = "";
					userGuess = "";
					answerText = "";
					questionsCorrect = 0;
					questionsIncorrect = 0;
					timerCount = 20;
					questionCounter = 0;
					$hiddenStuff.css('display', 'none');
					$showResults.empty();
					getNewQuestion();
					timerCountDown();
			});

			}

			getNewQuestion();
			timerCountDown();



			$submitButton.on('click', function(){
				
					event.preventDefault();									
					userGuess = ($(".option:checked").val());
					
					if (userGuess !== undefined){
							
						console.log("Question Number: " + questionCounter);
						console.log("User Input: " + userGuess);
						console.log("Correct Answer: " + correctAnswer);

						if (correctAnswer === userGuess){
							questionsCorrect += 1;
							questionCounter += 1;
							$showResults.html("You got it!! " + answerText);
							stopTimer();			
							}

						else{
							questionsIncorrect += 1;
							questionCounter += 1;
							$showResults.html("Nope! " + answerText);
							stopTimer();	
							}

						console.log("Questions Correct: " + questionsCorrect);
						console.log("Questions Incorrect: " + questionsIncorrect);
						timerCount = timerResetValue;
						// informationScreen();
						getNewQuestion();
						timerCountDown();


				}
		});


		}

	</script>

</body>
</html>